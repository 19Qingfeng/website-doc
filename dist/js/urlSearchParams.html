<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>urlSearchParams | Nx-website-component</title>
    <meta name="generator" content="VuePress 1.7.1">
    
    <meta name="description" content="Vue component for nx-website.">
    
    <link rel="preload" href="/docs/assets/css/0.styles.849a47af.css" as="style"><link rel="preload" href="/docs/assets/js/app.0bb1a5b1.js" as="script"><link rel="preload" href="/docs/assets/js/2.f0b9337b.js" as="script"><link rel="preload" href="/docs/assets/js/37.fb882a2d.js" as="script"><link rel="prefetch" href="/docs/assets/js/10.82a9ca1c.js"><link rel="prefetch" href="/docs/assets/js/11.1447e757.js"><link rel="prefetch" href="/docs/assets/js/12.5f684ad3.js"><link rel="prefetch" href="/docs/assets/js/13.2d378a4f.js"><link rel="prefetch" href="/docs/assets/js/14.d19066c7.js"><link rel="prefetch" href="/docs/assets/js/15.a3002422.js"><link rel="prefetch" href="/docs/assets/js/16.4581841e.js"><link rel="prefetch" href="/docs/assets/js/17.eecb3e98.js"><link rel="prefetch" href="/docs/assets/js/18.95585732.js"><link rel="prefetch" href="/docs/assets/js/19.25d169b9.js"><link rel="prefetch" href="/docs/assets/js/20.2f2b0760.js"><link rel="prefetch" href="/docs/assets/js/21.1c87ef69.js"><link rel="prefetch" href="/docs/assets/js/22.eda19953.js"><link rel="prefetch" href="/docs/assets/js/23.d8c0260a.js"><link rel="prefetch" href="/docs/assets/js/24.c0912537.js"><link rel="prefetch" href="/docs/assets/js/25.a11f2f87.js"><link rel="prefetch" href="/docs/assets/js/26.efd2525c.js"><link rel="prefetch" href="/docs/assets/js/27.fd333191.js"><link rel="prefetch" href="/docs/assets/js/28.875d93a9.js"><link rel="prefetch" href="/docs/assets/js/29.f2f7b6c5.js"><link rel="prefetch" href="/docs/assets/js/3.285d3745.js"><link rel="prefetch" href="/docs/assets/js/30.7a462313.js"><link rel="prefetch" href="/docs/assets/js/31.078f89e4.js"><link rel="prefetch" href="/docs/assets/js/32.6aa32e2f.js"><link rel="prefetch" href="/docs/assets/js/33.f8ace9be.js"><link rel="prefetch" href="/docs/assets/js/34.db0b7025.js"><link rel="prefetch" href="/docs/assets/js/35.2eb2fe16.js"><link rel="prefetch" href="/docs/assets/js/36.1656f138.js"><link rel="prefetch" href="/docs/assets/js/38.d206724d.js"><link rel="prefetch" href="/docs/assets/js/39.ffa465ed.js"><link rel="prefetch" href="/docs/assets/js/4.d6949b90.js"><link rel="prefetch" href="/docs/assets/js/40.32998e59.js"><link rel="prefetch" href="/docs/assets/js/41.48279e1d.js"><link rel="prefetch" href="/docs/assets/js/42.04d59b96.js"><link rel="prefetch" href="/docs/assets/js/43.6735f950.js"><link rel="prefetch" href="/docs/assets/js/44.be583b78.js"><link rel="prefetch" href="/docs/assets/js/45.ed499b24.js"><link rel="prefetch" href="/docs/assets/js/46.aa2df7b2.js"><link rel="prefetch" href="/docs/assets/js/5.eefddad5.js"><link rel="prefetch" href="/docs/assets/js/6.ffe6f60a.js"><link rel="prefetch" href="/docs/assets/js/7.9dde9a5b.js"><link rel="prefetch" href="/docs/assets/js/8.d28952e9.js"><link rel="prefetch" href="/docs/assets/js/9.d3d926f1.js">
    <link rel="stylesheet" href="/docs/assets/css/0.styles.849a47af.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/docs/" class="home-link router-link-active"><!----> <span class="site-name">Nx-website-component</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Install</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/chapter1/" class="sidebar-link">Introduction</a></li><li><a href="/docs/chapter1/dev.html" class="sidebar-link">开发</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>NxBg 背景图</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/chapter2/Props&amp;Event.html" class="sidebar-link">使用</a></li><li><a href="/docs/chapter2/demo.html" class="sidebar-link">代码演示</a></li><li><a href="/docs/chapter2/problem.html" class="sidebar-link">遗留问题</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>NxCard 卡片</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/chapter3/entry.html" class="sidebar-link">使用</a></li><li><a href="/docs/chapter3/demo.html" class="sidebar-link">代码演示</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>NxFooter 底部</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/chapter4/entry.html" class="sidebar-link">使用</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>NxArt 文章</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/chapter5/entry.html" class="sidebar-link">使用</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>NxSlide 幻灯片</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/chapter6/entry.html" class="sidebar-link">使用</a></li><li><a href="/docs/chapter6/demo.html" class="sidebar-link">代码演示</a></li><li><a href="/docs/chapter6/feat.html" class="sidebar-link">feat</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>版本记录</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/chapter7/entry.html" class="sidebar-link">修复记录</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>js</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/js/object.html" class="sidebar-link">Object 属性定义</a></li><li><a href="/docs/js/offset.html" class="sidebar-link">offset 相关属性</a></li><li><a href="/docs/js/client.html" class="sidebar-link">client 相关属性</a></li><li><a href="/docs/js/scroll.html" class="sidebar-link">scroll 相关属性</a></li><li><a href="/docs/js/page.html" class="sidebar-link">page 相关属性</a></li><li><a href="/docs/js/bodyOffset.html" class="sidebar-link">计算元素距离 body 的偏移量</a></li><li><a href="/docs/js/getSize.html" class="sidebar-link">获取隐藏元素宽高值</a></li><li><a href="/docs/js/getBoundingClientRect.html" class="sidebar-link">Element.getBoundingClientRect</a></li><li><a href="/docs/js/draggable.html" class="sidebar-link">draggable HTML 拖拽</a></li><li><a href="/docs/js/getImgSize.html" class="sidebar-link">获取图片原始尺寸</a></li><li><a href="/docs/js/node.html" class="sidebar-link">NodeType 元素节点属性</a></li><li><a href="/docs/js/fade.html" class="sidebar-link">JS 实现 JQ-fadeIn,fadeout</a></li><li><a href="/docs/js/location.html" class="sidebar-link">URL-location 对象</a></li><li><a href="/docs/js/decode.html" class="sidebar-link">URL 解码和编码</a></li><li><a href="/docs/js/urlSearchParams.html" aria-current="page" class="active sidebar-link">urlSearchParams</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/js/urlSearchParams.html#使用场景" class="sidebar-link">使用场景</a></li><li class="sidebar-sub-header"><a href="/docs/js/urlSearchParams.html#api" class="sidebar-link">api</a></li></ul></li><li><a href="/docs/js/getComputedStyle.html" class="sidebar-link">Window.getComputedStyle</a></li><li><a href="/docs/js/videoToImg.html" class="sidebar-link">上传视频生成缩略图</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>web socket</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/socket/pubNabVue.html" class="sidebar-link">pubnub-vue</a></li><li><a href="/docs/socket/hello.html" class="sidebar-link">Demo</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>nodejs</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/nodejs/zip.html" class="sidebar-link">压缩文件</a></li><li><a href="/docs/nodejs/unZip.html" class="sidebar-link">解压</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>vue</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/vue/defineReactive.html" class="sidebar-link">响应式对象</a></li><li><a href="/docs/vue/$nextTick.html" class="sidebar-link">$nextTick</a></li><li><a href="/docs/vue-source/chapter1.html" class="sidebar-link">New Vue 发生了什么</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="urlsearchparams"><a href="#urlsearchparams" class="header-anchor">#</a> urlSearchParams</h1> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>urlSearchParams 定义了使用 URL 的查询字符串的实用方法，但它兼容性不太好。</p> <p>而 FormData 接口提供了一种方法，可以轻松地构造一组表示表单字段及其值的键/值对，通常用在 Post 请中。</p> <p>urlSearchParams 和 FormData 完全是两个不同的东西。</p> <p>在请求体中携带urlSearchParams时使用toString()方法转化后会得到key=value形式的参数，这和formData发送请求时携带的参数类似。但是urlSearchParams并不局限于此功能，他还提供了解析这类 queryString以及很多解析Url使用功能。</p></div> <h2 id="使用场景"><a href="#使用场景" class="header-anchor">#</a> 使用场景</h2> <ol><li>场景一 获取浏览器地址参数</li></ol> <p>我们之前在获取浏览器地址参数时很多时候是通过对地址进行分割，然后拼接字段对象的方式来做的，类似</p> <blockquote><p>自己处理 location.search 进行截取获取 url 查询参数。</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">GetRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> url <span class="token operator">=</span> location<span class="token punctuation">.</span>search<span class="token punctuation">;</span> <span class="token comment">//获取url中&quot;?&quot;符后的字串</span>
  <span class="token keyword">let</span> theRequest <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>url<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">&quot;?&quot;</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> str <span class="token operator">=</span> url<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    strs <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;&amp;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> strs<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      theRequest<span class="token punctuation">[</span>strs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;=&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> strs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;=&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> theRequest<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>但是我们如果使用<code>URLSearchParams</code>时就不用这么繁琐了</p> <div class="language- extra-class"><pre class="language-text"><code>const params = new URLSearchParams(location.search)
params.get(key)
</code></pre></div><ol start="2"><li>使用 URLSearchParams 处理 axios 发送的数据</li></ol> <p>URLSearchParams 顾名思义，其实就是 URL 添加查询参数。</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>需要注意 xhr 发送请求时携带 URLSearchParams 时，请求头 Content-Type 通常配合 application/x-www-form-urlencoded。(axios 默认会如此处理)</p></div> <p>在我们使用 axios 和 fetch 来替换之前的 ajax 进行数据请求时，我们会遇到数据格式不一致的问题。</p> <div class="language- extra-class"><pre class="language-text"><code>axios({
    method: 'post',
    url: '/test',
    data: {
        name: 'li lei',
        age: 18
    }
})
</code></pre></div><p>上面的调用方法和我们使用 ajax 时非常相似，我们可能也会自然而然的这样来写，但是我们会发现，其默认的数据格式是有差别的：
<img src="https://user-gold-cdn.xitu.io/2019/5/7/16a91491e8cb50ac?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="request payload">
ajax 数据格式：
<img src="https://user-gold-cdn.xitu.io/2019/5/7/16a91491e9d58899?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="formData">
是的，多了一层包裹，这样和我们后端的对接就出现问题了。哪怕是手动去修改 ContentType 为 application/x-www-form-urlencoded 仍然没有解决。
<img src="https://user-gold-cdn.xitu.io/2019/5/7/16a91491e8e0e041?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="png"></p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>请求中使用 URLSearchParams 参数，会将请求数据格式为 formdata 形式。</p></div> <div class="language- extra-class"><pre class="language-text"><code>let params = new URLSearchParams();
params.append('name', 'li lei');
params.append('age', 18);

// axios中如果传递的是一个URLSearchParams的话，那么自动会调用URLSearchParams.toString()之后进行拼接。
axios({
    method: 'post',
    url: '/test',
    data: params
})
</code></pre></div><h2 id="api"><a href="#api" class="header-anchor">#</a> api</h2> <ul><li>append(name, value):插入一个指定的键/值对作为新的搜索参数。</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> url <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URL</span><span class="token punctuation">(</span><span class="token string">&quot;https://example.com?foo=1&amp;bar=2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> params <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URLSearchParams</span><span class="token punctuation">(</span>url<span class="token punctuation">.</span>search<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//添加第二个foo搜索参数。</span>
params<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;foo&quot;</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
params<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 'foo=1&amp;bar=2&amp;foo=4'</span>
</code></pre></div><ul><li>delete(name):从搜索参数列表里删除指定的搜索参数及其对应的值。
name 是需要删除的键值名称。</li></ul> <div class="language- extra-class"><pre class="language-text"><code>let url = new URL('https://example.com?foo=1&amp;bar=2');
let params = new URLSearchParams(url.search.slice(1));

//添加第二个foo搜索参数。
params.delete('foo');
params.toString();
// 'bar=2'
</code></pre></div><ul><li>entries():返回一个 iterator 可以遍历所有键/值对的对象。</li></ul> <div class="language- extra-class"><pre class="language-text"><code>// 创建一个测试用 URLSearchParams 对象
let searchParams = new URLSearchParams(&quot;key1=value1&amp;key2=value2&quot;);

// 显示键/值对
for(var pair of searchParams.entries()) {
   console.log(pair[0]+ ', '+ pair[1]);
}

// key1, value1
// key2, value2
</code></pre></div><ul><li>get(name):获取指定搜索参数的第一个值。
name 是将要返回的参数的键名。返回一个 USVString；如果没有，则返回 null。
如果一个页面的 URL 是 https://example.com/?name=Jonathan&amp;age=18 ，你可以这样解析参数 name 和 age:</li></ul> <div class="language- extra-class"><pre class="language-text"><code>let params = new URLSearchParams(document.location.search.substring(1));
let name = params.get(&quot;name&quot;); // is the string &quot;Jonathan&quot;
let age = parseInt(params.get(&quot;age&quot;), 10); // is the number 18

// 查找一个不存在的键名则返回 null:
let address = params.get(&quot;address&quot;); // null
</code></pre></div><ul><li>getAll(name):获取指定搜索参数的所有值，返回是一个数组。
name 是返回的参数的名称。</li></ul> <div class="language- extra-class"><pre class="language-text"><code>let url = new URL('https://example.com?foo=1&amp;bar=2');
let params = new URLSearchParams(url.search.slice(1));

//为foo参数添加第二个值
params.append('foo', 4);

console.log(params.getAll('foo'))' //输出 [&quot;1&quot;,&quot;4&quot;].
</code></pre></div><ul><li>has(name):返回 Boolean 判断是否存在此搜索参数。
name 是我们要查询的参数的键名。</li></ul> <div class="language- extra-class"><pre class="language-text"><code>let url = new URL('https://example.com?foo=1&amp;bar=2');
let params = new URLSearchParams(url.search.slice(1));

params.has('bar') === true; //true
</code></pre></div><ul><li>keys():返回 iterator 此对象包含了键/值对的所有键名。</li></ul> <div class="language- extra-class"><pre class="language-text"><code>// 建立一个测试用URLSearchParams对象
let searchParams = new URLSearchParams(&quot;key1=value1&amp;key2=value2&quot;);

// 输出键值对
for(var key of searchParams.keys()) {
  console.log(key);
}

// key1
// key2
</code></pre></div><ul><li>set(name, value):设置一个搜索参数的新值，假如原来有多个值将删除其他所有的值。
其中 name 是需要插入修改参数的键名，value 是需要插入搜索参数的新值。</li></ul> <div class="language- extra-class"><pre class="language-text"><code>let url = new URL('https://example.com?foo=1&amp;bar=2');
let params = new URLSearchParams(url.search.slice(1));

//Add a third parameter.
params.set('baz', 3);
</code></pre></div><ul><li>sort(): 按键名排序。</li></ul> <div class="language- extra-class"><pre class="language-text"><code>// Create a test URLSearchParams object
let searchParams = new URLSearchParams(&quot;c=4&amp;a=2&amp;b=3&amp;a=1&quot;);

// Sort the key/value pairs
searchParams.sort();

// Display the sorted query string
console.log(searchParams.toString());

// a=2&amp;a=1&amp;b=3&amp;c=4
</code></pre></div><ul><li>toString():返回搜索参数组成的字符串，可直接使用在 URL 上。</li></ul> <div class="language- extra-class"><pre class="language-text"><code>let url = new URL('https://example.com?foo=1&amp;bar=2');
let params = new URLSearchParams(url.search.slice(1));

//Add a second foo parameter.
params.append('foo', 4);
console.log(params.toString());
//Prints 'foo=1&amp;bar=2&amp;foo=4'.
</code></pre></div><ul><li>values():返回 iterator 此对象包含了键/值对的所有值。</li></ul> <div class="language- extra-class"><pre class="language-text"><code>// 创建一个测试用URLSearchParams对象
let searchParams = new URLSearchParams(&quot;key1=value1&amp;key2=value2&quot;);

// 输出值
for(var value of searchParams.values()) {
  console.log(value);
}
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/docs/js/decode.html" class="prev">
        URL 解码和编码
      </a></span> <span class="next"><a href="/docs/js/getComputedStyle.html">
        Window.getComputedStyle
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/docs/assets/js/app.0bb1a5b1.js" defer></script><script src="/docs/assets/js/2.f0b9337b.js" defer></script><script src="/docs/assets/js/37.fb882a2d.js" defer></script>
  </body>
</html>
